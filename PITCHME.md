<style>
.reveal .slides {
    text-align: left;
}
.reveal h1, .reveal h2, .reveal h3, .reveal h3, .reveal h4, .reveal h5, .reveal h6 {
    text-transform: none;
}
.reveal .force-center {
    text-align: center;
}
.reveal .size-l {
    font-size: 1.3em;
}
.reveal .size-s {
    font-size: 0.7em;
}
.reveal .color-yellow {
    color: #f9d67a;
}
.reveal .color-blue {
    color: #7cdbf3;
}
.reveal .color-green {
    color: #c8eb79;
}
.reveal .color-red {
    color: #f9a0a0;
}
.reveal .color-purple {
    color: #a18fff;
}
.reveal section img {
    border: 0;
    box-shadow: none;
}
.reveal .slides section .fragment.highlight-red.visible {
    color: #f9a0a0;
}
</style>
### CODE BLUE CTF 2017で出した問題の話
@Charo\_IT

---

## $ whoami

<div style="float: left; padding-right: 20px">
<img src="https://avatars1.githubusercontent.com/u/12444598?s=200&v=4" width="200px" height="200px" />
</div>

@Charo\_IT (しゃろ)
* CTF (scryptos / binja)
  * binary exploitation (pwn)
  * reverse engeneering (rev)

<div style="clear: both"></div>

---

## Contents
* About CODE BLUE & CODE BLUE CTF 2017
* Simple Memo Pad (pwn)
* fs hell (rev)

---

## About CODE BLUE

<div class="size-s">
    <ul>
        <li>世界トップクラスのセキュリティ専門家による日本発の情報セキュリティ国際会議</li>
        <li>今年は11/7-10に東京で開催<ul>
            <li>Geohot氏による基調講演を含む20以上の講演</li>
            <li>2つのトレーニング</li>
            <li>6つのコンテスト</li>
        </ul></li>
    </ul>
</div>

---

## About CODE BLUE CTF 2017

<div class="size-s">
    <ul>
        <li>今年のCODE BLUEで開かれたコンテストの1つ</li>
        <li>日本のCTFチームbinja/TokyoWesternsが作問・運営</li>
        <li>全世界から554チームがオンラインまたはオンサイトで参加</li>
    </ul>
</div>

---

### 今回作成した問題

<div class="size-s">
    <ul>
        <li>Secret Mailer Service (pwn)</li>
        <li><span class="fragment highlight-red" data-fragment-index="1">Simple Memo Pad (pwn)</span></li>
        <li><span class="fragment highlight-red" data-fragment-index="1">fs hell (rev)</span></li>
        <li>Incident Response (for/rev)</li>
    </ul>
</div>

---

## Simple Memo Pad (pwn)

---

### CTFにおけるpwn (pwnable)とは

<div class="size-s">
    <ul>
        <li>稼動中のプログラムに存在する脆弱性を利用してメモリの値を不正に書き換え、プログラムに不正な動作をさせる<ul>
            <li>Buffer overflow</li>
            <li>Use After Free</li>
            <li>Out-of-bounds Write&nbsp;&nbsp;&nbsp;etc.</li>
        </ul></li>
        <li>大抵の場合、任意の機械語またはコマンドの実行ができる状態まで持って行ければ得点になる</li>
    </ul>
</div>

---

### realworldでのpwnの応用例

<div class="size-s">
    <ul>
        <li>EternalBlue<ul>
            <li>Windows SMBv1に存在したBuffer overflowを利用したexploit</li><li>WannaCryの拡散に使われた</li>
        </ul></li>
        <li>BlueBorne<ul>
            <li>様々なプラットフォームにおけるBluetoothの実装に存在する脆弱性の総称</li>
            <li>Buffer overflowによりリモートから任意コード実行が可能というものも含まれる</li>
        </ul></li>
        <li>Jailbreak・root奪取</li>
    </ul>
</div>

---

### CTFにおけるpwn (pwnable)とは

<div class="size-s">
    <ul>
        <li>稼動中のプログラムに存在する脆弱性を利用して<span class="fragment highlight-red">メモリの値を不正に書き換え</span>、プログラムに不正な動作をさせる<ul>
            <li>Buffer overflow</li>
            <li>Use After Free</li>
            <li>Out-of-bounds Write&nbsp;&nbsp;&nbsp;etc.</li>
        </ul></li>
        <li>大抵の場合、任意の機械語またはコマンドの実行ができる状態まで持って行ければ得点になる</li>
    </ul>
</div>

---

<span class="color-red">どこ</span>を書き換えるとプログラムを乗っ取れる？

<div class="size-s">
    <ul>
        <li class="fragment">関数ポインタ・スタック上のリターンアドレス</li>
        <li class="fragment">関数ポインタの配列を指すポインタ</li>
        <li class="fragment">関数ポインタの配列を指すポインタを指すポインタ<span class="fragment">を指すポインタ<span class="fragment">を指すポインタ<span class="fragment">&nbsp;&nbsp;&nbsp;etc.</span></span></span></li>
    </ul>
</div>

<span class="size-s fragment">でもポインタ経由で関数を呼び出すことってそんなにないのでは？</span>  
<span class="size-s fragment">→ <span class="color-yellow">ライブラリ関数の呼び出し</span></span>

---

ライブラリ関数呼び出しの仕組み

```c
int main(){
    puts("Hello world");
    return 0;
}
```
<span class="size-s">普通のHello world</span>

+++

ライブラリ関数呼び出しの仕組み

<span class="size-s">出力されるバイナリ（動的リンク時）</span>
```c
int main(){
    puts@plt("Hello world");
    return 0;
}
```
@[2](`puts`呼び出しが`puts@plt`呼び出しに変わっている)

+++
<!-- .slide: data-transition="slide-in fade-out" -->

ライブラリ関数呼び出しの仕組み

<span class="size-s">初回の`puts@plt`呼び出し</span>
```c
int (*puts@got.plt)(const char *) = puts@plt.got;

int puts@plt(const char *s){
    return puts@got.plt(s);
}

int puts@plt.got(const char *s){
    puts@got.plt = _dl_runtime_resolve(link_map, 0);
    return puts@got.plt(s);
}
```
@[1-5](`puts@got.plt`経由で`puts@plt.got`を呼ぶ)
@[7-10](`puts`のアドレス解決をし、結果を`puts@got.plt`にキャッシュした上で`puts`を呼ぶ)

+++
<!-- .slide: data-transition="none" -->

ライブラリ関数呼び出しの仕組み

<span class="size-s">2回目以降の`puts@plt`呼び出し</span>
```c
int (*puts@got.plt)(const char *) = puts;

int puts@plt(const char *s){
    return puts@got.plt(s);
}

int puts@plt.got(const char *s){
    puts@got.plt = _dl_runtime_resolve(link_map, 0);
    return puts@got.plt(s);
}
```
@[1-5](`puts@got.plt`経由でライブラリ内の`puts`を呼ぶ)

---
<!-- .slide: data-transition="fade" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><rect x="0" y="380" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><rect x="0" y="340" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><path d="M 80 260 Q 110 260 110 230 Q 110 200 90.24 200" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 200 L 90.24 196 L 90.24 204 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#ffffff" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><path d="M 80 400 Q 120 400 120 354 Q 120 308 148.76 308" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 156.76 308 L 148.76 312 L 148.76 304 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g></g></svg>
</div>
<div>
    <ol>
        <li>`call puts@plt`</li>
    </ol>
</div>
<div style="clear: both"></div>

+++
<!-- .slide: data-transition="fade" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><rect x="0" y="380" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><rect x="0" y="340" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#ffffff" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><path d="M 80 400 Q 120 400 120 354 Q 120 308 148.76 308" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 156.76 308 L 148.76 312 L 148.76 304 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><path d="M 80 200 Q 110 200 110 300 Q 110 400 90.24 400" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 400 L 90.24 396 L 90.24 404 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/></g></svg>
</div>
<div>
    <ol>
        <li>`call puts@plt`</li>
        <li>`jmp [puts@.got.plt]`</li>
    </ol>
</div>
<div style="clear: both"></div>

+++
<!-- .slide: data-transition="fade" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><rect x="0" y="380" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><rect x="0" y="340" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><path d="M 80 400 Q 120 400 120 354 Q 120 308 148.76 308" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 156.76 308 L 148.76 312 L 148.76 304 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g></g></svg>
</div>
<div>
    <ol>
        <li>`call puts@plt`</li>
        <li>`jmp [puts@.got.plt]`</li>
        <li>puts本体へ制御が移る</li>
    </ol>
</div>
<div style="clear: both"></div>

---
<!-- .slide: data-transition="fade" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><rect x="0" y="380" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><rect x="0" y="340" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><path d="M 80 400 Q 120 400 120 255 Q 120 110 148.76 110" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 156.76 110 L 148.76 114 L 148.76 106 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><rect x="160" y="100" width="80" height="80" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(174.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="50" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 52px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">shellcode</div></div></foreignObject><text x="25" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">shellcode</text></switch></g></g></svg>
</div>
<div>
    GOT overwrite  
    <div class="size-s">
        .got.pltを不正に書き換えることで、<br>
        ライブラリ関数呼び出し時にプログラムの制御を奪ってしまう手法<br><br>
    </div>
</div>
<div style="clear: both"></div>

+++
<!-- .slide: data-transition="fade" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><rect x="0" y="380" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><rect x="0" y="340" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><path d="M 80 400 Q 120 400 120 255 Q 120 110 148.76 110" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 156.76 110 L 148.76 114 L 148.76 106 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><rect x="160" y="100" width="80" height="80" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(174.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="50" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 52px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">shellcode</div></div></foreignObject><text x="25" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">shellcode</text></switch></g></g></svg>
</div>
<div>
    利用法1  
    <div class="size-s">
        あらかじめデータ領域に機械語を置いておき、<br>
        .got.pltのポインタをそこに向ければ任意コード実行ができる<br>
    </div>
</div>
<div style="clear: both"></div>

+++
<!-- .slide: data-transition="fade" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><rect x="0" y="380" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><rect x="0" y="340" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><path d="M 80 400 Q 120 400 120 395 Q 120 390 148.76 390" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 156.76 390 L 148.76 394 L 148.76 386 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><rect x="160" y="380" width="80" height="80" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(180.5,413.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="38" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 40px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">system</div></div></foreignObject><text x="19" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">system</text></switch></g></g></svg>
</div>
<div>
    利用法2
    <div class="size-s">
        .got.pltのポインタを`system`関数に向けることで、任意コマンド実行を行う
    </div>
</div>
<div style="clear: both"></div>

---

セキュリティ機構の数々

<div class="size-s">
    <ul>
        <li>NX bit</li>
        <li>RELRO</li>
        <li>ASLR, PIE</li>
    </ul>
</div>

---

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><rect x="0" y="380" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><rect x="0" y="340" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><path d="M 80 400 Q 120 400 120 255 Q 120 110 148.76 110" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 156.76 110 L 148.76 114 L 148.76 106 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><rect x="160" y="100" width="80" height="80" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(174.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="50" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 52px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">shellcode</div></div></foreignObject><text x="25" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">shellcode</text></switch></g><path d="M 115.97 103.97 L 109.97 106.78 L 111.9 100.97 L 107.07 103.97 L 108.9 99.27 L 103 100.87 L 107.07 96.46 L 100.96 96.26 L 106.22 92.75 L 100 90.85 L 105.68 88.25 L 100.32 85.64 L 106.32 84.23 L 100.86 79.93 L 106.97 79.83 L 103 75.13 L 108.79 76.13 L 106.32 71.32 L 112.33 73.22 L 110.93 68.71 L 116.83 70.62 L 115.97 66.16 L 120.58 69.32 L 121.22 64.31 L 125.08 68.01 L 125.51 63.41 L 130.55 66.91 L 132.48 61.3 L 135.69 66.21 L 137.19 60.6 L 140.94 66.01 L 143.52 60 L 145.87 65.81 L 148.87 60 L 150.48 66.01 L 154.98 61 L 154.45 66.31 L 159.38 60.6 L 159.06 66.61 L 164.84 61.4 L 165.49 67.11 L 170.85 62.7 L 170.95 68.71 L 177.06 64.41 L 175.56 70.02 L 183.17 66.21 L 180.28 71.82 L 189.92 67.81 L 185.85 73.62 L 194.43 71.92 L 191.32 77.03 L 197.75 76.93 L 193.25 80.13 L 200 81.24 L 194.21 84.04 L 199.89 85.84 L 193.03 86.84 L 199.04 90.35 L 192.82 90.85 L 197.43 94.86 L 190.25 93.56 L 194.11 98.86 L 187.89 96.66 L 190.78 101.77 L 184.89 100.77 L 185.53 106.08 L 181.78 102.97 L 181.03 108.68 L 177.17 104.77 L 176.85 111.29 L 172.88 106.08 L 170.95 112.19 L 168.27 106.68 L 165.59 113.79 L 163.99 107.68 L 160.99 113.89 L 158.95 108.18 L 156.59 113.99 L 154.56 108.18 L 151.88 114.59 L 150.38 108.18 L 147.59 113.79 L 146.3 107.48 L 142.98 114.29 L 141.59 107.48 L 138.91 114.79 L 138.16 107.88 L 134.73 115.19 L 133.12 106.68 L 130.65 113.39 L 128.72 107.88 L 104.07 120 Z" fill="#f9d67a" stroke="#000000" stroke-width="2" stroke-miterlimit="10" transform="translate(150,0)scale(-1,1)translate(-150,0)" pointer-events="none"/><g transform="translate(125.5,83.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 49px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">実行不可</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">実行不可</text></switch></g></g></svg>
</div>
<div>
    NX bit (No eXecute)
    <div class="size-s">
        データ領域にある機械語を実行できてしまうのが悪い！<br>
        &nbsp;→&nbsp;メモリ上の領域ごとに実行可/不可を設定できるように
    </div>
</div>
<div style="clear: both"></div>

---

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="312px" version="1.1" viewBox="0 0 312 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="71" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(99.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="71" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(102.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><rect x="71" y="380" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(92.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="71" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(99.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="71" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(96.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(78.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="71" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(88.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="71" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(92.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><rect x="71" y="340" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(86.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="71" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(87.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="71" y="140" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(86.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="231" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(247.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><path d="M 151 400 Q 191 400 191 255 Q 191 110 219.76 110" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 227.76 110 L 219.76 114 L 219.76 106 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(257.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><rect x="231" y="100" width="80" height="80" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(245.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="50" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 52px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">shellcode</div></div></foreignObject><text x="25" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">shellcode</text></switch></g><path d="M 16.97 383.97 L 10.97 386.78 L 12.9 380.97 L 8.07 383.97 L 9.9 379.27 L 4 380.87 L 8.07 376.46 L 1.96 376.26 L 7.22 372.75 L 1 370.85 L 6.68 368.25 L 1.32 365.64 L 7.32 364.23 L 1.86 359.93 L 7.97 359.83 L 4 355.13 L 9.79 356.13 L 7.32 351.32 L 13.33 353.22 L 11.93 348.71 L 17.83 350.62 L 16.97 346.16 L 21.58 349.32 L 22.22 344.31 L 26.08 348.01 L 26.51 343.41 L 31.55 346.91 L 33.48 341.3 L 36.69 346.21 L 38.19 340.6 L 41.94 346.01 L 44.52 340 L 46.87 345.81 L 49.87 340 L 51.48 346.01 L 55.98 341 L 55.45 346.31 L 60.38 340.6 L 60.06 346.61 L 65.84 341.4 L 66.49 347.11 L 71.85 342.7 L 71.95 348.71 L 78.06 344.41 L 76.56 350.02 L 84.17 346.21 L 81.28 351.82 L 90.92 347.81 L 86.85 353.62 L 95.43 351.92 L 92.32 357.03 L 98.75 356.93 L 94.25 360.13 L 101 361.24 L 95.21 364.04 L 100.89 365.84 L 94.03 366.84 L 100.04 370.35 L 93.82 370.85 L 98.43 374.86 L 91.25 373.56 L 95.11 378.86 L 88.89 376.66 L 91.78 381.77 L 85.89 380.77 L 86.53 386.08 L 82.78 382.97 L 82.03 388.68 L 78.17 384.77 L 77.85 391.29 L 73.88 386.08 L 71.95 392.19 L 69.27 386.68 L 66.59 393.79 L 64.99 387.68 L 61.99 393.89 L 59.95 388.18 L 57.59 393.99 L 55.56 388.18 L 52.88 394.59 L 51.38 388.18 L 48.59 393.79 L 47.3 387.48 L 43.98 394.29 L 42.59 387.48 L 39.91 394.79 L 39.16 387.88 L 35.73 395.19 L 34.12 386.68 L 31.65 393.39 L 29.72 387.88 L 5.07 400 Z" fill="#f9d67a" stroke="#000000" stroke-width="2" stroke-miterlimit="10" transform="translate(51,0)scale(-1,1)translate(-51,0)" pointer-events="none"/><g transform="translate(21.5,363.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="57" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 59px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Read-Only</div></div></foreignObject><text x="29" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Read-Only</text></switch></g></g></svg>
</div>
<div>
    RELRO (RELocation Read-Only)
    <div class="size-s">
        GOTが書き換え可能なのが悪い！<br>
        &nbsp;→&nbsp;Read-Onlyに<br>
        <br>
        <div class="fragment">
            <ul>
                <li>No RELRO → GOT overwrite可能</li>
                <li>Partial RELRO → GOT overwrite可能</li>
                <li>Full RELRO → GOT overwrite不可</li>
            </ul>
        </div>
    </div>
</div>
<div style="clear: both"></div>

---

<div style="float: right">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="332px" version="1.1" viewBox="0 0 332 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="91" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(119.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="91" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(122.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><rect x="91" y="380" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(112.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="91" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(119.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="91" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(116.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(98.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="91" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(108.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="91" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(112.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><rect x="91" y="340" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(106.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="91" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(107.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="91" y="140" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(106.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="251" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(267.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><path d="M 171 400 Q 211 400 211 395 Q 211 390 239.76 390" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 247.76 390 L 239.76 394 L 239.76 386 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(277.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><rect x="251" y="380" width="80" height="80" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(271.5,413.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="38" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 40px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">system</div></div></foreignObject><text x="19" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">system</text></switch></g><path d="M 20.16 383.97 L 12.96 386.78 L 15.28 380.97 L 9.49 383.97 L 11.68 379.27 L 4.6 380.87 L 9.49 376.46 L 2.16 376.26 L 8.46 372.75 L 1 370.85 L 7.82 368.25 L 1.39 365.64 L 8.59 364.23 L 2.03 359.93 L 9.36 359.83 L 4.6 355.13 L 11.55 356.13 L 8.59 351.32 L 15.79 353.22 L 14.12 348.71 L 21.19 350.62 L 20.16 346.16 L 25.69 349.32 L 26.47 344.31 L 31.1 348.01 L 31.61 343.41 L 37.66 346.91 L 39.97 341.3 L 43.83 346.21 L 45.63 340.6 L 50.13 346.01 L 53.22 340 L 56.05 345.81 L 59.65 340 L 61.58 346.01 L 66.98 341 L 66.34 346.31 L 72.25 340.6 L 71.87 346.61 L 78.81 341.4 L 79.59 347.11 L 86.02 342.7 L 86.14 348.71 L 93.48 344.41 L 91.68 350.02 L 100.81 346.21 L 97.33 351.82 L 108.91 347.81 L 104.02 353.62 L 114.31 351.92 L 110.58 357.03 L 118.3 356.93 L 112.9 360.13 L 121 361.24 L 114.05 364.04 L 120.87 365.84 L 112.64 366.84 L 119.84 370.35 L 112.38 370.85 L 117.91 374.86 L 109.3 373.56 L 113.93 378.86 L 106.47 376.66 L 109.94 381.77 L 102.86 380.77 L 103.64 386.08 L 99.14 382.97 L 98.23 388.68 L 93.6 384.77 L 93.22 391.29 L 88.46 386.08 L 86.14 392.19 L 82.93 386.68 L 79.71 393.79 L 77.78 387.68 L 74.18 393.89 L 71.74 388.18 L 68.91 393.99 L 66.47 388.18 L 63.25 394.59 L 61.45 388.18 L 58.11 393.79 L 56.56 387.48 L 52.58 394.29 L 50.9 387.48 L 47.69 394.79 L 46.79 387.88 L 42.67 395.19 L 40.74 386.68 L 37.78 393.39 L 35.47 387.88 L 5.89 400 Z" fill="#f9d67a" stroke="#000000" stroke-width="2" stroke-miterlimit="10" transform="translate(61,0)scale(-1,1)translate(-61,0)" pointer-events="none"/><g transform="translate(18.5,363.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="84" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 85px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">アドレスが不定</div></div></foreignObject><text x="42" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">アドレスが不定</text></switch></g><path d="M 200.16 383.97 L 192.96 386.78 L 195.28 380.97 L 189.49 383.97 L 191.68 379.27 L 184.6 380.87 L 189.49 376.46 L 182.16 376.26 L 188.46 372.75 L 181 370.85 L 187.82 368.25 L 181.39 365.64 L 188.59 364.23 L 182.03 359.93 L 189.36 359.83 L 184.6 355.13 L 191.55 356.13 L 188.59 351.32 L 195.79 353.22 L 194.12 348.71 L 201.19 350.62 L 200.16 346.16 L 205.69 349.32 L 206.47 344.31 L 211.1 348.01 L 211.61 343.41 L 217.66 346.91 L 219.97 341.3 L 223.83 346.21 L 225.63 340.6 L 230.13 346.01 L 233.22 340 L 236.05 345.81 L 239.65 340 L 241.58 346.01 L 246.98 341 L 246.34 346.31 L 252.25 340.6 L 251.87 346.61 L 258.81 341.4 L 259.59 347.11 L 266.02 342.7 L 266.14 348.71 L 273.48 344.41 L 271.68 350.02 L 280.81 346.21 L 277.33 351.82 L 288.91 347.81 L 284.02 353.62 L 294.31 351.92 L 290.58 357.03 L 298.3 356.93 L 292.9 360.13 L 301 361.24 L 294.05 364.04 L 300.87 365.84 L 292.64 366.84 L 299.84 370.35 L 292.38 370.85 L 297.91 374.86 L 289.3 373.56 L 293.93 378.86 L 286.47 376.66 L 289.94 381.77 L 282.86 380.77 L 283.64 386.08 L 279.14 382.97 L 278.23 388.68 L 273.6 384.77 L 273.22 391.29 L 268.46 386.08 L 266.14 392.19 L 262.93 386.68 L 259.71 393.79 L 257.78 387.68 L 254.18 393.89 L 251.74 388.18 L 248.91 393.99 L 246.47 388.18 L 243.25 394.59 L 241.45 388.18 L 238.11 393.79 L 236.56 387.48 L 232.58 394.29 L 230.9 387.48 L 227.69 394.79 L 226.79 387.88 L 222.67 395.19 L 220.74 386.68 L 217.78 393.39 L 215.47 387.88 L 185.89 400 Z" fill="#f9d67a" stroke="#000000" stroke-width="2" stroke-miterlimit="10" transform="translate(241,0)scale(-1,1)translate(-241,0)" pointer-events="none"/><g transform="translate(198.5,363.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="84" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 85px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">アドレスが不定</div></div></foreignObject><text x="42" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">アドレスが不定</text></switch></g></g></svg>
</div>
<div>
    ASLR (Address Space Layout Randomization)  
    PIE (Position-Independent Executable)
    <div class="size-s">
        各種アドレスが固定なのが悪い！<br>
        &nbsp;→&nbsp;アドレスをランダムに<br>
        <br>
        <ul>
            <li>ASLR → ライブラリやスタック</li>
            <li>PIE → 実行ファイル本体</li>
        </ul>
    </div>
</div>
<div style="clear: both"></div>

---

ここまではCTFerにはよく知られている話

---

ここからさらに掘り下げます

---

<span class="size-s">ようやく本題の</span>  
### Simple Memo Pad

---

双方向リンクリストを使ったメモ管理アプリ
```shell
$ ./simple_memo_pad
*******************************
*       Simple Memo Pad       *
*******************************
                     Ver. Alpha


1. Write a note on a blank area
2. Edit a note
3. Delete a note
4. Show a note
5. Quit
>
```

+++

<div class="force-center">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="558px" version="1.1" viewBox="0 0 558 201" style="max-width:100%;max-height:201px;"><defs/><g transform="translate(0.5,0.5)"><rect x="78" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(102.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><path d="M 158 140 Q 198 140 198 75 Q 198 10 229.76 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 235.76 10 L 227.76 14 L 229.76 10 L 227.76 6 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="78" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(106.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><rect x="78" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(105.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="238" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(262.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><path d="M 318 140 Q 358 140 358 75 Q 358 10 389.76 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 395.76 10 L 387.76 14 L 389.76 10 L 387.76 6 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="238" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(266.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><path d="M 238 180 Q 188 180 188 95 Q 188 10 166.24 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 160.24 10 L 168.24 6 L 166.24 10 L 168.24 14 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="238" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(265.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="398" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(422.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><rect x="398" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(426.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><path d="M 398 180 Q 348 180 348 95 Q 348 10 326.24 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 320.24 10 L 328.24 6 L 326.24 10 L 328.24 14 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="398" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(425.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><path d="M 78 180 Q 28 180 28 95 Q 28 10 6.24 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 0.24 10 L 8.24 6 L 6.24 10 L 8.24 14 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 478 140 Q 518 140 518 75 Q 518 10 549.76 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 555.76 10 L 547.76 14 L 549.76 10 L 547.76 6 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/></g></svg>
</div>

---

脆弱性
<div class="size-s">
    <ul>
        <li>1回だけBuffer overflowでリンクリストを壊せる<br>メモを削除する際に影響あり</li>
    </ul>
</div>

---
<!-- .slide: data-transition="fade" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="401px" version="1.1" viewBox="0 0 401 201" style="max-width:100%;max-height:201px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(24.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><path d="M 80 140 Q 120 140 120 75 Q 120 10 151.76 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 10 L 149.76 14 L 151.76 10 L 149.76 6 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><rect x="0" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(27.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="160" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(184.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><path d="M 240 140 Q 280 140 280 75 Q 280 10 311.76 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 317.76 10 L 309.76 14 L 311.76 10 L 309.76 6 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="160" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(188.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><path d="M 160 180 Q 110 180 110 95 Q 110 10 88.24 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 10 L 90.24 6 L 88.24 10 L 90.24 14 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="160" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(187.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="320" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(344.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><rect x="320" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(348.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><path d="M 320 180 Q 270 180 270 95 Q 270 10 248.24 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 242.24 10 L 250.24 6 L 248.24 10 L 250.24 14 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="320" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(347.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g></g></svg>
</div>
<div>
    正常な場合の削除処理
</div>
<div style="clear: both"></div>

+++
<!-- .slide: data-transition="fade" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="401px" version="1.1" viewBox="0 0 401 281" style="max-width:100%;max-height:281px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(24.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><rect x="0" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><rect x="0" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(27.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="160" y="80" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(184.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><path d="M 240 220 Q 280 220 280 115 Q 280 10 311.76 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 317.76 10 L 309.76 14 L 311.76 10 L 309.76 6 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="160" y="200" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(188.5,213.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><path d="M 160 260 Q 110 260 110 135 Q 110 10 88.24 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 10 L 90.24 6 L 88.24 10 L 90.24 14 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="160" y="240" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(187.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="320" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(344.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><rect x="320" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(348.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><path d="M 320 180 Q 270 180 270 95 Q 270 10 88.24 10" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 10 L 90.24 6 L 88.24 10 L 90.24 14 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="320" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(347.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><path d="M 80 140 Q 150 140 150 75 Q 150 10 311.76 10" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 317.76 10 L 309.76 14 L 311.76 10 L 309.76 6 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/></g></svg>
</div>
<div>
    正常な場合の削除処理
    <div class="size-s">
        `memo->prev->next = memo->next`<br>
        `memo->next->prev = memo->prev`
    </div>
</div>
<div style="clear: both"></div>

---
<!-- .slide: data-transition="fade" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="401px" version="1.1" viewBox="0 0 401 201" style="max-width:100%;max-height:201px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(24.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><path d="M 80 140 Q 120 140 120 75 Q 120 10 151.76 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 10 L 149.76 14 L 151.76 10 L 149.76 6 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><rect x="0" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(27.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="160" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(184.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><path d="M 240 140 Q 280 140 280 75 Q 280 10 311.76 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 317.76 10 L 309.76 14 L 311.76 10 L 309.76 6 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="160" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(188.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><path d="M 160 180 Q 110 180 110 95 Q 110 10 88.24 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 10 L 90.24 6 L 88.24 10 L 90.24 14 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="160" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(187.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="320" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(344.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><rect x="320" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(348.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><path d="M 320 180 Q 270 180 270 95 Q 270 10 248.24 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 242.24 10 L 250.24 6 L 248.24 10 L 250.24 14 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="320" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(347.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g></g></svg>
</div>
<div>
    異常な場合の削除処理
</div>
<div style="clear: both"></div>

+++
<!-- .slide: data-transition="fade" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="401px" version="1.1" viewBox="0 0 401 441" style="max-width:100%;max-height:441px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(24.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><path d="M 80 140 Q 120 140 120 75 Q 120 10 151.76 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 10 L 149.76 14 L 151.76 10 L 149.76 6 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><rect x="0" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(27.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="160" y="0" width="80" height="120" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(184.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><path d="M 240 140 Q 270 140 270 195 Q 270 250 311.76 250" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 317.76 250 L 309.76 254 L 311.76 250 L 309.76 246 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="160" y="120" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(188.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><path d="M 160 180 Q 110 180 110 95 Q 110 10 88.24 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 10 L 90.24 6 L 88.24 10 L 90.24 14 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="160" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(187.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="320" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(344.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><rect x="320" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(348.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><path d="M 320 180 Q 270 180 270 95 Q 270 10 248.24 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 242.24 10 L 250.24 6 L 248.24 10 L 250.24 14 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="320" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(347.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="320" y="240" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="320" y="360" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="320" y="400" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/></g></svg>
</div>
<div>
    異常な場合の削除処理
    <div class="size-s">
        Buffer overflow発生
    </div>
</div>
<div style="clear: both"></div>

+++
<!-- .slide: data-transition="fade" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="401px" version="1.1" viewBox="0 0 401 441" style="max-width:100%;max-height:441px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(24.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><path d="M 80 140 Q 120 140 120 197 Q 120 254 310.76 254" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 316.76 254 L 308.76 258 L 310.76 254 L 308.76 250 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><rect x="0" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(27.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="160" y="0" width="80" height="120" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(184.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><path d="M 240 140 Q 270 140 270 195 Q 270 250 311.76 250" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 317.76 250 L 309.76 254 L 311.76 250 L 309.76 246 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="160" y="120" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(188.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><path d="M 160 180 Q 110 180 110 95 Q 110 10 88.24 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 10 L 90.24 6 L 88.24 10 L 90.24 14 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="160" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(187.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="320" y="0" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(344.5,53.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="30" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 32px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">buffer</div></div></foreignObject><text x="15" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">buffer</text></switch></g><rect x="320" y="120" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(348.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">next</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">next</text></switch></g><path d="M 320 180 Q 270 180 270 95 Q 270 10 248.24 10" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 242.24 10 L 250.24 6 L 248.24 10 L 250.24 14 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="320" y="160" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(347.5,173.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">prev</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">prev</text></switch></g><rect x="320" y="240" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="320" y="360" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 320 420 Q 130 420 130 215 Q 130 10 88.24 10" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 10 L 90.24 6 L 88.24 10 L 90.24 14 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="320" y="400" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/></g></svg>
</div>
<div>
    異常な場合の削除処理
    <div class="size-s">
        `memo->prev->next = memo->next`<br>
        `memo->next->prev = memo->prev`
    </div>
</div>
<div style="clear: both"></div>

---

この脆弱性を使ってできること
<div class="size-s">
    <ul>
        <li>任意の場所にメモのアドレスを1回だけ書き込める<br>メモの内容は攻撃者がコントロール可能</li>
    </ul>
</div>

<br>
<div class="fragment size-s">これだけ（アドレスリークもなし）</div>

---

セキュリティ機構の有無
<div class="size-s">
    <ul>
        <li>No RELRO<span class="fragment"> → .got.pltはWritable</span></li>
        <li>NX Enabled<span class="fragment"> → データ領域に機械語を置いても実行できない</span></li>
        <li>ASLR Enabled, No PIE<span class="fragment"> → 本体以外のアドレスがランダム</span></li>
    </ul>
</div>

---

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><rect x="0" y="380" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><rect x="0" y="340" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><path d="M 80 400 Q 120 400 120 255 Q 120 110 148.76 110" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 156.76 110 L 148.76 114 L 148.76 106 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><rect x="160" y="100" width="80" height="80" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(174.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="50" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 52px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">shellcode</div></div></foreignObject><text x="25" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">shellcode</text></switch></g><path d="M 115.97 103.97 L 109.97 106.78 L 111.9 100.97 L 107.07 103.97 L 108.9 99.27 L 103 100.87 L 107.07 96.46 L 100.96 96.26 L 106.22 92.75 L 100 90.85 L 105.68 88.25 L 100.32 85.64 L 106.32 84.23 L 100.86 79.93 L 106.97 79.83 L 103 75.13 L 108.79 76.13 L 106.32 71.32 L 112.33 73.22 L 110.93 68.71 L 116.83 70.62 L 115.97 66.16 L 120.58 69.32 L 121.22 64.31 L 125.08 68.01 L 125.51 63.41 L 130.55 66.91 L 132.48 61.3 L 135.69 66.21 L 137.19 60.6 L 140.94 66.01 L 143.52 60 L 145.87 65.81 L 148.87 60 L 150.48 66.01 L 154.98 61 L 154.45 66.31 L 159.38 60.6 L 159.06 66.61 L 164.84 61.4 L 165.49 67.11 L 170.85 62.7 L 170.95 68.71 L 177.06 64.41 L 175.56 70.02 L 183.17 66.21 L 180.28 71.82 L 189.92 67.81 L 185.85 73.62 L 194.43 71.92 L 191.32 77.03 L 197.75 76.93 L 193.25 80.13 L 200 81.24 L 194.21 84.04 L 199.89 85.84 L 193.03 86.84 L 199.04 90.35 L 192.82 90.85 L 197.43 94.86 L 190.25 93.56 L 194.11 98.86 L 187.89 96.66 L 190.78 101.77 L 184.89 100.77 L 185.53 106.08 L 181.78 102.97 L 181.03 108.68 L 177.17 104.77 L 176.85 111.29 L 172.88 106.08 L 170.95 112.19 L 168.27 106.68 L 165.59 113.79 L 163.99 107.68 L 160.99 113.89 L 158.95 108.18 L 156.59 113.99 L 154.56 108.18 L 151.88 114.59 L 150.38 108.18 L 147.59 113.79 L 146.3 107.48 L 142.98 114.29 L 141.59 107.48 L 138.91 114.79 L 138.16 107.88 L 134.73 115.19 L 133.12 106.68 L 130.65 113.39 L 128.72 107.88 L 104.07 120 Z" fill="#f9d67a" stroke="#000000" stroke-width="2" stroke-miterlimit="10" transform="translate(150,0)scale(-1,1)translate(-150,0)" pointer-events="none"/><g transform="translate(125.5,83.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 49px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">実行不可</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">実行不可</text></switch></g></g></svg>
</div>
<div>
    GOT overwrite
    <div class="size-s">
        NX Enabledなのでメモに置いた機械語が実行できない<br>
        &nbsp;→&nbsp;NG
    </div>
</div>
<div style="clear: both"></div>

---

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="242px" version="1.1" viewBox="0 0 242 301" style="max-width:100%;max-height:301px;"><defs/><g transform="translate(0.5,0.5)"><g transform="translate(26.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><rect x="0" y="20" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="160" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(178.5,26.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="42" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 44px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">function<div>pointer</div></div></div></foreignObject><text x="21" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 80 160 Q 120 160 120 100 Q 120 40 151.76 40" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="2 2" pointer-events="none"/><path d="M 157.76 40 L 149.76 44 L 151.76 40 L 149.76 36 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 160 Q 120 160 120 180 Q 120 200 151.76 200" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 200 L 149.76 204 L 151.76 200 L 149.76 196 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="140" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,146.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">vtable<div>pointer</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="180" width="80" height="120" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="160" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(178.5,66.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="42" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 44px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">function<div>pointer</div></div></div></foreignObject><text x="21" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="160" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(178.5,106.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="42" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 44px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">function<div>pointer</div></div></div></foreignObject><text x="21" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="160" y="180" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(180.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="38" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 40px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">system</div></div></foreignObject><text x="19" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">system</text></switch></g><rect x="160" y="220" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(180.5,233.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="38" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 40px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">system</div></div></foreignObject><text x="19" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">system</text></switch></g><rect x="160" y="260" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(180.5,273.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="38" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 40px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">system</div></div></foreignObject><text x="19" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">system</text></switch></g><g transform="translate(158.5,160.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="83" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 83px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">fake <span>vtable</span></div></div></foreignObject><text x="42" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></g></svg>
</div>
<div>
    glibc内部にある関数ポインタの配列へのポインタを上書き
    <div class="size-s">
        NXは回避できるが、<br>
        ASLRがあるのでアドレスが分からない<br>
        アドレスリークができる脆弱性もない<br>
        &nbsp;→&nbsp;NG
    </div>
</div>
<div style="clear: both"></div>

---

<span class="size-s">Buffer overflowはあるけど</span>  
攻撃が成立しないのでセキュア（完）

---

セキュリティ機構の有無
<div class="size-s">
    <ul>
        <li><span class="fragment highlight-red">No RELRO</span> → .got.pltはWritable</li>
        <li>NX Enabled → データ領域に機械語を置いても実行できない</li>
        <li>ASLR Enabled, No PIE → 本体以外のアドレスがランダム</li>
    </ul>
</div>

---

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="312px" version="1.1" viewBox="0 0 312 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="71" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(99.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="71" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(102.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><rect x="71" y="380" width="80" height="40" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(92.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="71" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(99.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="71" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(96.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(78.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="71" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(88.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="71" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(92.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><rect x="71" y="340" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(86.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="71" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(87.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="71" y="140" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(86.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="231" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(247.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><path d="M 151 400 Q 191 400 191 255 Q 191 110 219.76 110" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 227.76 110 L 219.76 114 L 219.76 106 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(257.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><rect x="231" y="100" width="80" height="80" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(245.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="50" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 52px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">shellcode</div></div></foreignObject><text x="25" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">shellcode</text></switch></g><path d="M 16.97 383.97 L 10.97 386.78 L 12.9 380.97 L 8.07 383.97 L 9.9 379.27 L 4 380.87 L 8.07 376.46 L 1.96 376.26 L 7.22 372.75 L 1 370.85 L 6.68 368.25 L 1.32 365.64 L 7.32 364.23 L 1.86 359.93 L 7.97 359.83 L 4 355.13 L 9.79 356.13 L 7.32 351.32 L 13.33 353.22 L 11.93 348.71 L 17.83 350.62 L 16.97 346.16 L 21.58 349.32 L 22.22 344.31 L 26.08 348.01 L 26.51 343.41 L 31.55 346.91 L 33.48 341.3 L 36.69 346.21 L 38.19 340.6 L 41.94 346.01 L 44.52 340 L 46.87 345.81 L 49.87 340 L 51.48 346.01 L 55.98 341 L 55.45 346.31 L 60.38 340.6 L 60.06 346.61 L 65.84 341.4 L 66.49 347.11 L 71.85 342.7 L 71.95 348.71 L 78.06 344.41 L 76.56 350.02 L 84.17 346.21 L 81.28 351.82 L 90.92 347.81 L 86.85 353.62 L 95.43 351.92 L 92.32 357.03 L 98.75 356.93 L 94.25 360.13 L 101 361.24 L 95.21 364.04 L 100.89 365.84 L 94.03 366.84 L 100.04 370.35 L 93.82 370.85 L 98.43 374.86 L 91.25 373.56 L 95.11 378.86 L 88.89 376.66 L 91.78 381.77 L 85.89 380.77 L 86.53 386.08 L 82.78 382.97 L 82.03 388.68 L 78.17 384.77 L 77.85 391.29 L 73.88 386.08 L 71.95 392.19 L 69.27 386.68 L 66.59 393.79 L 64.99 387.68 L 61.99 393.89 L 59.95 388.18 L 57.59 393.99 L 55.56 388.18 L 52.88 394.59 L 51.38 388.18 L 48.59 393.79 L 47.3 387.48 L 43.98 394.29 L 42.59 387.48 L 39.91 394.79 L 39.16 387.88 L 35.73 395.19 L 34.12 386.68 L 31.65 393.39 L 29.72 387.88 L 5.07 400 Z" fill="#f9d67a" stroke="#000000" stroke-width="2" stroke-miterlimit="10" transform="translate(51,0)scale(-1,1)translate(-51,0)" pointer-events="none"/><g transform="translate(21.5,363.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="57" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 59px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Read-Only</div></div></foreignObject><text x="29" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Read-Only</text></switch></g></g></svg>
</div>
<div>
    RELRO (RELocation Read-Only)
    <div class="size-s">
        GOTが書き換え可能なのが悪い！<br>
        &nbsp;→&nbsp;Read-Onlyに<br>
        <br>
        <div>
            <ul>
                <li><span class="fragment highlight-red" data-fragment-index="1">No RELRO → GOT overwrite可能</span></li>
                <li><span class="fragment highlight-red" data-fragment-index="1">Partial RELRO → GOT overwrite可能</span></li>
                <li>Full RELRO → GOT overwrite不可</li>
            </ul>
            <br><br>
            <span class="fragment color-red" data-fragment-index="1">この2つの違いは？</span>
        </div>
    </div>
</div>
<div style="clear: both"></div>

---

No RELRO → Partial RELROで<br>Read-Onlyになるセクション
<div class="size-s">
    <ul>
        <li>.init_array</li>
        <li>.fini_array</li>
        <li>.got (.got.pltはWritableのまま)</li>
        <li><span class="fragment highlight-red">.dynamic</span>&nbsp;&nbsp;&nbsp;etc.</li>
    </ul>
</div>

---
<!-- .slide: data-transition="fade" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><path d="M 80 400 Q 120 400 120 355 Q 120 310 151.76 310" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 310 L 149.76 314 L 151.76 310 L 149.76 306 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="380" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><rect x="0" y="340" width="80" height="40" fill="#f9d67a" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g></g></svg>
</div>
<div>
    .dynamicには何が入っている？
</div>
<div style="clear: both"></div>

+++
<!-- .slide: data-transition="fade-in slide-out" -->

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><path d="M 80 400 Q 120 400 120 355 Q 120 310 151.76 310" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 310 L 149.76 314 L 151.76 310 L 149.76 306 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="380" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><path d="M 80 360 Q 130 360 130 200 Q 130 40 88.24 40" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 40 L 90.24 36 L 88.24 40 L 90.24 44 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 120 360 120 220 Q 120 80 88.24 80" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 80 L 90.24 76 L 88.24 80 L 90.24 84 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 110 360 110 240 Q 110 120 88.24 120" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 120 L 90.24 116 L 88.24 120 L 90.24 124 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 100 360 100 260 Q 100 160 88.24 160" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 160 L 90.24 156 L 88.24 160 L 90.24 164 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 100 360 100 380 Q 100 400 88.24 400" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 400 L 90.24 396 L 88.24 400 L 90.24 404 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="340" width="80" height="40" fill="#f9d67a" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g></g></svg>
</div>
<div>
    .dynamicには何が入っている？
    <div class="size-s">
        ライブラリ関数のアドレス解決に必要な情報がどこにあるか
    </div>
</div>
<div style="clear: both"></div>

+++

<div class="force-center">
    <img src="https://github.com/Charo-IT/slides/raw/kernel_vm_kansai_8/assets/img/dynamic.png">
</div>

+++

<div style="float: right; padding-right: 20px">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><path d="M 80 400 Q 120 400 120 355 Q 120 310 151.76 310" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 310 L 149.76 314 L 151.76 310 L 149.76 306 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="380" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><path d="M 80 360 Q 130 360 130 200 Q 130 40 88.24 40" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 40 L 90.24 36 L 88.24 40 L 90.24 44 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 120 360 120 220 Q 120 80 88.24 80" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 80 L 90.24 76 L 88.24 80 L 90.24 84 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 110 360 110 240 Q 110 120 88.24 120" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 120 L 90.24 116 L 88.24 120 L 90.24 124 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 100 360 100 260 Q 100 160 88.24 160" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 160 L 90.24 156 L 88.24 160 L 90.24 164 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 100 360 100 380 Q 100 400 88.24 400" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 400 L 90.24 396 L 88.24 400 L 90.24 404 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="340" width="80" height="40" fill="#f9d67a" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g></g></svg>
</div>
<div>
    .dynamicには何が入っている？
    <div class="size-s">
        ライブラリ関数のアドレス解決に必要な情報がどこにあるか<br><br>
        <span class="fragment color-red">.dynamicを書き換えれば、攻撃者の望むライブラリ関数が呼べるのでは？</span>
    </div>
</div>
<div style="clear: both"></div>

---
<!-- .slide: data-transition="fade" -->

どのエントリを書き換えるか？

<div class="force-center">
    <img src="https://github.com/Charo-IT/slides/raw/kernel_vm_kansai_8/assets/img/dynamic.png" width="498px" height="470px" />
</div>

+++
<!-- .slide: data-transition="fade-in slide-out" -->

どのエントリを書き換えるか？

<div class="force-center">
    <img src="https://github.com/Charo-IT/slides/raw/kernel_vm_kansai_8/assets/img/dynamic_highlight.png" width="498px" height="470px" />
</div>

+++
<!-- .slide: data-transition="slide" -->

<div class="force-center">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><path d="M 80 400 Q 120 400 120 355 Q 120 310 151.76 310" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 310 L 149.76 314 L 151.76 310 L 149.76 306 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="380" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><path d="M 80 360 Q 130 360 130 200 Q 130 40 88.24 40" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 40 L 90.24 36 L 88.24 40 L 90.24 44 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 110 360 110 240 Q 110 120 88.24 120" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 120 L 90.24 116 L 88.24 120 L 90.24 124 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 100 360 100 260 Q 100 160 88.24 160" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 160 L 90.24 156 L 88.24 160 L 90.24 164 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 100 360 100 380 Q 100 400 88.24 400" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 400 L 90.24 396 L 88.24 400 L 90.24 404 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 120 360 120 215.5 Q 120 71 151.76 71" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 71 L 149.76 75 L 151.76 71 L 149.76 67 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="340" width="80" height="40" fill="#f9d67a" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><rect x="160" y="60" width="80" height="80" fill="#f9a0a0" stroke="#000000" pointer-events="none"/></g></svg>
</div>

---

strtab (.dynstr)の中身
<div class="force-center">
    <img src="https://github.com/Charo-IT/lides/raw/kernel_vm_kansai_8/assets/img/strtab.png"/>
</div>
<div class="size-s">
    ライブラリ関数の名前など<br>
    <span class="fragment color-red">偽のstrtabを参照するように.dynamicを書き換えると……？</span>
</div>

---

<div class="force-center">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><path d="M 80 400 Q 120 400 120 355 Q 120 310 151.76 310" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 310 L 149.76 314 L 151.76 310 L 149.76 306 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="380" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><path d="M 80 360 Q 130 360 130 200 Q 130 40 88.24 40" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 40 L 90.24 36 L 88.24 40 L 90.24 44 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 110 360 110 240 Q 110 120 88.24 120" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 120 L 90.24 116 L 88.24 120 L 90.24 124 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 100 360 100 260 Q 100 160 88.24 160" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 160 L 90.24 156 L 88.24 160 L 90.24 164 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 100 360 100 380 Q 100 400 88.24 400" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 400 L 90.24 396 L 88.24 400 L 90.24 404 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 120 360 120 215.5 Q 120 71 151.76 71" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 71 L 149.76 75 L 151.76 71 L 149.76 67 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="340" width="80" height="40" fill="#f9d67a" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><rect x="160" y="60" width="80" height="80" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(163.5,72.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="72" height="54" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 74px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">AAAAAAAAA<div>AAAAAAAAA</div><div>AAAAAAAAA</div><div>AAAAAAAAA</div></div></div></foreignObject><text x="36" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></g></svg>
</div>

+++

<div class="size-s">
`./simple_memo_pad: relocation error: ./simple_memo_pad: symbol AAAAAAAAAAAAAAAAAAAA, version GLIBC_2.2.5 not defined in file libc.so.6 with link time reference`
</div>

---

<div class="force-center">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="241px" version="1.1" viewBox="0 0 241 461" style="max-width:100%;max-height:461px;"><defs/><g transform="translate(0.5,0.5)"><rect x="0" y="220" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,253.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.text</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.text</text></switch></g><rect x="0" y="180" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(31.5,193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 18px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.plt</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.plt</text></switch></g><path d="M 80 400 Q 120 400 120 355 Q 120 310 151.76 310" fill="none" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 310 L 149.76 314 L 151.76 310 L 149.76 306 Z" fill="#ffffff" stroke="#ffffff" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="380" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.got<div>.got.plt</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="420" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(28.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.bss</div></div></foreignObject><text x="11" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.bss</text></switch></g><rect x="0" y="300" width="80" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(25.5,313.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="28" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 30px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(gap)</div></div></foreignObject><text x="14" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(gap)</text></switch></g><g transform="translate(7.5,0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 64px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">program</div></div></foreignObject><text x="32" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">program</text></switch></g><rect x="0" y="20" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(17.5,33.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="44" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 46px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynsym</div></div></foreignObject><text x="22" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynsym</text></switch></g><rect x="0" y="60" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(21.5,73.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 38px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynstr</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynstr</text></switch></g><path d="M 80 360 Q 130 360 130 200 Q 130 40 88.24 40" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 40 L 90.24 36 L 88.24 40 L 90.24 44 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 110 360 110 240 Q 110 120 88.24 120" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 120 L 90.24 116 L 88.24 120 L 90.24 124 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 100 360 100 260 Q 100 160 88.24 160" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 160 L 90.24 156 L 88.24 160 L 90.24 164 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 100 360 100 380 Q 100 400 88.24 400" fill="none" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 82.24 400 L 90.24 396 L 88.24 400 L 90.24 404 Z" fill="#7cdbf3" stroke="#7cdbf3" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 80 360 Q 120 360 120 215.5 Q 120 71 151.76 71" fill="none" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 157.76 71 L 149.76 75 L 151.76 71 L 149.76 67 Z" fill="#f9a0a0" stroke="#f9a0a0" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="340" width="80" height="40" fill="#f9d67a" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.dynamic</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.dynamic</text></switch></g><rect x="0" y="100" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(16.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.dyn</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.dyn</text></switch></g><rect x="0" y="140" width="80" height="40" fill="#7cdbf3" stroke="#000000" pointer-events="none"/><g transform="translate(15.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">.rela.sym</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">.rela.sym</text></switch></g><rect x="160" y="300" width="80" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(176.5,333.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="46" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">puts本体</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">puts本体</text></switch></g><g transform="translate(186.5,280.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="26" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 26px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">libc</div></div></foreignObject><text x="13" y="18" fill="#FFFFFF" text-anchor="middle" font-size="17px" font-family="Helvetica">libc</text></switch></g><rect x="160" y="60" width="80" height="80" fill="#f9a0a0" stroke="#000000" pointer-events="none"/><g transform="translate(161.5,72.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="76" height="54" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 76px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">AAAAAAAAA<div>AAAAAAAAA</div><div>AA<b>system\0</b>A</div><div>AAAAAAAAA</div></div></div></foreignObject><text x="38" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></g></svg>
</div>

+++

<div class="force-center">
    <img src="https://github.com/Charo-IT/slides/raw/kernel_vm_kansai_8/assets/img/win.png"/>
</div>
<div class="size-s">
    `strcmp(user_input, "y")`の代わりに`system(user_input)`が呼ばれるようにするとシェルが取れる
</div>

---

最終的な解法

<div class="size-s">
    <ol>
        <li class="fragment">"system"という文字列を埋め込んだ偽のstrtabを作る</li>
        <li class="fragment">Buffer overflowでリンクリストを壊す</li>
        <li class="fragment">メモの削除を行うことで.dynamicのstrtabのエントリを偽strtabに向ける</li>
        <li class="fragment">メニューからQuitを選び、コマンドを入力すると`strcmp`の代わりに`system`が呼ばれてシェルが起動する</li>
    </ol>
</div>

---

<span class="size-s">問題のテーマ</span>

No RELROとPartial RELROの違いを理解しましょう

---

裏話

<div class="size-s">
    <ul>
        <li>HITCON CTF 2015 QualsのBlinkrootを解く途中で思いついた手法を問題にした</li>
        <li>作問した後、2015年にShellphishのメンバーがDEFCON等で既に発表していた手法だったことを発見</li>
        <li>解いたのは8/554チーム</li>
    </ul>
</div>

---

## fs hell (rev)

---

### printf("%d", 0);

+++

### printf("%d", <span class="color-yellow">0</span>);

<span class="color-yellow">0</span>を出力

---

### printf("%<span class="color-blue">3$</span>d", 2, 1, <span class="color-yellow">0</span>);

<span class="color-blue">3</span>番目の引数<span class="color-yellow">0</span>を出力

---

### printf("%<span class="color-blue">3$</span><span class="color-green">5</span>d", 2, 1, <span class="color-yellow">0</span>);

<span class="color-blue">3</span>番目の引数<span class="color-yellow">0</span>を  
表示幅<span class="color-green">5</span>で出力  
→"\_\_\_\_5"

---

### printf("%<span class="color-blue">3$</span><span class="color-red">\*4$</span>d", 2, 1, <span class="color-yellow">0</span>, <span class="color-green">5</span>);

<span class="color-blue">3</span>番目の引数<span class="color-yellow">0</span>を  
<span class="color-red">4</span>番目の引数で指定された表示幅<span class="color-green">5</span>で出力

---

### printf("%<span class="color-blue">3$</span><span class="color-red">\*4$</span>d<span class="color-purple">%5$n</span>, 2, 1, <span class="color-yellow">0</span>, <span class="color-green">5</span>, <span class="color-purple">&amp;a</span>);

<span class="color-blue">3</span>番目の引数<span class="color-yellow">0</span>を  
<span class="color-red">4</span>番目の引数で指定された表示幅<span class="color-green">5</span>で出力し、  
<span class="color-purple">5</span>番目の引数で指定された変数<span class="color-purple">a</span>に  
それまでの出力文字数をintで格納する

---

How about this?

### printf("%4$\*1$d%4$\*2$d%3$n", 2, 3, &amp;a, 0);

+++

### printf("<span class="color-blue">%4$.\*1$d</span><span class="color-yellow">%4$.\*2$d</span><span class="color-green">%3$n</span>", <span class="color-blue">2</span>, <span class="color-yellow">3</span>, <span class="color-green">&amp;a</span>, 0);

<span class="fragment"><span class="color-blue">0を表示幅2で出力</span>し、</span>  
<span class="fragment">さらに<span class="color-yellow">0を表示幅3で出力</span>し、</span>  
<span class="fragment"><span class="color-green">それまでの出力文字数(2+3=5)を変数aに格納</span>する</span>

<span class="fragment">**format stringで足し算ができる！** 楽しい！</span><span class="fragment">（？）</span>

---

ということで……

**format stringで動く処理系**  
を解析する問題を作ってみた

---

### 問題
fs\_hell, program.txtを解析し、
```shell
$ ./fs_hell program.txt input.txt
Congratz!
```
と出力されるようなinput.txtを求めよ

---

#### program.txt（抜粋）

```
%14$.*5$d%14$.23d%10$hhn
%14$.*4$d%14$.8d%9$hn
%14$.*5$d%14$.49d%10$hhn
%14$.*4$d%14$.18d%9$hn
%14$.*5$d%14$.84d%10$hhn
%14$.*4$d%14$.65534d%9$hn
%14$.*5$d%14$.10d%10$hhn
%14$.*4$d%14$.65525d%9$hn
%14$.*5$d%14$.30d%10$hhn

%14$.255d%6$hn
%14$.513d%9$hn
%14$.*12$d%13$hn
%14$.1d%13$hn
%14$.4d%13$hn
%14$.*1$d%10$hhn
%14$.*4$d%14$.1d%9$hn
%14$.*1$d%14$.65535d%6$hn
%14$.65529d%13$hn

%14$.256d%9$hn
%14$.0d%10$hn
%14$.258d%9$hn
```

<span class="size-s">format stringが約180行書かれたテキストファイル</span>

---

#### fs\_hell

<span class="size-s">処理系本体となるELFバイナリ</span>

```shell
$ file fs_hell
fs_hell: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=2871bb49cefe81e91d2b2e67c19d0510cfabc19c, stripped
```

---

#### fs\_hell

<span class="size-s">データ構造</span>

```c
unsigned char memory[0x10000];

struct cpu{
    unsigned short pc;
    unsigned short delta_pc;
    unsigned short ax;
    unsigned short bx;
    unsigned short cx;
    unsigned short px;
};
```

@[1](メモリ。コマンドライン引数で指定したファイルの内容が初期化時に読み込まれる)
@[4](プログラムカウンタ)
@[5](ジャンプ・ループ・条件分岐用(`next_pc = pc + delta_pc + 1`))
@[6-8](汎用レジスタ)
@[9](`memory`へのアクセス用のレジスタ)

---

#### fs\_hell

<span class="size-s">動作のしくみ</span>
```c
while(program[vmcpu->pc] != NULL){
    snprintf(&dummybuf, 1, program[vmcpu->pc],
        vmcpu->ax,  // 1
        vmcpu->bx,  // 2
        vmcpu->cx,  // 3
        vmcpu->px,  // 4
        memory[vmcpu->px],  // 5
        &vmcpu->ax,  // 6
        &vmcpu->bx,  // 7
        &vmcpu->cx,  // 8
        &vmcpu->px,  // 9
        &memory[vmcpu->px], // 10
        vmcpu->ax == 0,  // 11
        (vmcpu->ax & 0x8000) != 0,  // 12
        &vmcpu->delta_pc,  // 13
        0  // 14
    );
    vmcpu->pc += 1;
    vmcpu->pc += vmcpu->delta_pc;
    vmcpu->delta_pc = 0;
}
```

@[2](`snprintf`本体（program.txtの内容を1行ずつ実行）)
@[3-16](引数にはレジスタやメモリの値・アドレス、フラグを設定)
@[3-7](レジスタ、メモリからの読み取り用)
@[8-12](レジスタ、メモリへの書き込み用)
@[13-14](ZeroFlag, SignedFlag)
@[15,18-20](ジャンプ・ループ・条件分岐用)

---

#### fs\_hellでできること
##### 1. 足し算

<div class="size-s">
    <ul>
        <li>レジスタ + レジスタ/メモリ/直値</li>
        <li>メモリ + 直値</li>
        <li>直値 + 直値</li>
    </ul>
</div>

<br>
<div class="fragment size-s">
複数のレジスタ/メモリ/直値を続けて出力することで、  
1命令(=1行)で3項以上の足し算もできる  
<span class="color-blue">%14$.\*1$d</span><span class="color-yellow">%14$.\*2$d</span><span class="color-green">%14$.\*3$d</span><span class="color-red">%6$hhn</span> → <span class="color-red">ax</span> = (unsigned char)(<span class="color-blue">ax</span> + <span class="color-yellow">bx</span> + <span class="color-green">cx</span>)
</div>

---

#### fs\_hellでできること
##### 2. 引き算……？

<div class="size-s">
    <ul>
        <li>レジスタ/メモリ - 直値 (2の補数の足し算に直しただけ)</li>
    </ul>
</div>

<br />
<div class="fragment size-s">
レジスタの値の符号反転をシュッと行う方法が思いつかなかったため、  
プログラム内で符号反転用のテーブルを作ることで、  
レジスタ同士の引き算ができるようにした
</div>

---

#### fs\_hellでできること
##### 3-1. 左ビットシフト

<span class="size-z">ax += ax</span>

+++

#### fs\_hellでできること
##### 3-2. 右ビットシフト

```c
// 1bit 右シフト
(unsigned short *)&memory[px] = (unsigned short)ax << 7;
ax = (unsigned char)memory[px + 1];
```

@[2](7bit 左シフトしたものを"%hn"(short)でメモリに保存する)
@[3](保存した16bit値の上位8bitのみを取り出す)

---

#### fs\_hellでできること
##### 4. ジャンプ

```c
while(program[vmcpu->pc] != NULL){
    snprintf(&dummybuf, 1, program[vmcpu->pc],
        // :
        // :
        vmcpu->ax == 0,  // 11
        (vmcpu->ax & 0x8000) != 0,  // 12
        &vmcpu->delta_pc,  // 13
        0  // 14
    );
    vmcpu->pc += 1;
    vmcpu->pc += vmcpu->delta_pc;
    vmcpu->delta_pc = 0;
}
```

@[7,10-12](delta\_pcに値を入れることで、次に実行される命令を指定可能)

---

#### fs\_hellでできること
##### 5. 条件分岐

```c
while(program[vmcpu->pc] != NULL){
    snprintf(&dummybuf, 1, program[vmcpu->pc],
        // :
        // :
        vmcpu->ax == 0,  // 11  ←ZeroFlag
        (vmcpu->ax & 0x8000) != 0,  // 12  ←SignedFlag
        &vmcpu->delta_pc,  // 13
        0  // 14
    );
    vmcpu->pc += 1;
    vmcpu->pc += vmcpu->delta_pc;
    vmcpu->delta_pc = 0;
}
```

@[5-7,10-12](ZeroFlagやSignedFlagをdelta\_pcに代入することで条件分岐が可能)

---

#### program.txtの解析

<span class="size-s">program.txtをがんばって解析すると、こんな処理になっていることが分かる</span>

```python
input = open(sys.argv[2], "rb").read()

key = [67, 65, 204, 214, 142, 225, 48, 135, 216, 218, 230, 196, 49, 185, 84, 227, 145, 45, 8, 114, 179, 179, 36, 15, 96, 68, 113, 48, 23, 212, 121, 34, 48, 162, 151, 164, 175, 56, 39]

k = 0
is_wrong_answer = False
for i in range(len(key)):
    k = (rotate_left(ord(input[i]), i % 8) - k) & 0xff
    if k != key[i]:
        is_wrong_answer = True
```

@[3](テーブルkeyをメモリ上に展開)
@[5-10](入力ファイルの内容を処理した結果とkeyが等しいかをチェックし、すべて一致すればOK)

---

#### solverの例

<span class="size-s">ただのビットローテートと加減算なので、普通に逆算する</span>

```python
key = [67, 65, 204, 214, 142, 225, 48, 135, 216, 218, 230, 196, 49, 185, 84, 227, 145, 45, 8, 114, 179, 179, 36, 15, 96, 68, 113, 48, 23, 212, 121, 34, 48,162, 151, 164, 175, 56, 39]

flag = ""
k = 0
for i in range(len(key)):
    flag += chr(rotate_right(k + key[i], i % 8))
    k = key[i]
print flag
```

@[1-8](→ `CBCTF{Do_Y0U_W4nt_MOR3_foRm4t_57RiNg5?}`)

+++

```shell
$ cat flag.txt
CBCTF{Do_Y0U_W4nt_MOR3_foRm4t_57RiNg5?}
$ ./fs_hell program.txt flag.txt
Congratz!
```

---

#### 裏話など

<div class="size-s">
    <ul>
        <li>解いたのは11/554チーム</li>
        <li>最速で正答したのは韓国の強豪Cykor（1時間45分）</li>
        <li>がんばればAND, OR, XORといったビット演算もできる？</li>
    </ul>
</div>

---

#### おわりに

他の問題も力作なので挑戦してみてください！
